# 动态链接库查找顺序 Dynamic-link Library Search Order

- https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-search-order#factors-that-affect-searching

## 影响查找的因素

- 一下因素影响系统是否查找DLL
  - 1.若具有相同模块名称的DLL已经加载到内存中，在处理加载DLL前，系统仅检测重定向和Manifest文件，无论DLL在那个目录，系统不会查找DLL；
  - 2.若DLL在应用系统运行的版本的系统的已知DLL列表中（Known DLLS），系统使用已知DLL已经相关依赖DLL的复制对象，从而不会进行DLL查找，当前系统已知DLL： `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs`
  - 3.若DLL有依赖，系统搜索依赖DLL